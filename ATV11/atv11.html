<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Centro Cirúrgico</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

</head>
<body>
  
  <div class="container">
    <div class="alert alert-success" id="msg-alerta" style="display: none;">
      <a href="#" onclick="ocultar()" class="close" data-dismiss="alert" aria-label="close">&times;</a>
      <samp id="msg"></samp>
    </div>
    
    <form id="form" class="form-horizontal" action="">
      <input type="hidden" id="id">
      <div class="form-group">
        <h2>Painel Centro Cirurgico</h2>
        <!-- LINHA 1 -->
        <div class="row">
          <div class="col-sm-6">
            <label class="control-label" for="">Nome do paciente:</label> <br>

            <input type="nome" class="form-control" id="nome" placeholder="Enter nome" name="nome">
          </div>

          <div class="col-sm-3">
            <label class="control-label" for="">Status:</label> <br>

            <select id="status" class="form-control">
              <option value="1">Pré Operatório</option>
              <option value="2">Em sala de Cirurgia</option>
              <option value="3">Sala de Recuperação</option>
              <option value="4">Transferido</option>
            </select>
          </div>

          <div class="col-sm-3">
            <label class="control-label" for="">Local:</label> <br>

            <input type="nome" class="form-control" id="local">
          </div>
        </div> <br>

        <!-- LINHA 2 -->
        <div class="row">
          <div class="col-sm-3">
            <label class="control-label" for="">Hora início:</label> <br>

            <input id="hora-inicio" type="time" class="form-control">
          </div>

          <div class="col-sm-3">
            <label class="control-label" for="">Início Previsto:</label> <br>

            <input id="inicio-previsto" type="time" class="form-control">
          </div>

          <div class="col-sm-3">
            <label class="control-label" for="">Fim previsto:</label> <br>

            <input id="fim-previsto" type="time" class="form-control">
          </div>

          <div class="col-sm-3">
            <label class="control-label" for="">Saída prevista:</label> <br>

            <input id="saida-prevista" type="time" class="form-control">
          </div>

        </div>
      </div>

      <div class="form-group">
        <button onclick="novo()" class="btn btn-default">Novo</button>
        <button onclick="gravar()" class="btn btn-primary">Gravar</button>
        <button id="btApagar" onclick="apagar()" class="btn btn-danger">Apagar</button>
      </div>
    </form> <br>

    <!-- TABELA -->
    <!-- <table class="table table-striped table-hover">
      <tbody id="tbCorpo">
        <thead>
          <tr>
            <th>Nome Paciente</th>
            <th>Status</th>
            <th>Hora Início</th>
            <th>Início Previsto</th>
            <th>Fim Previsto</th>
            <th>Saída Prevista</th>
          </tr>
        </thead>

      </tbody>
    </table>
    <ul class="pagination">
    </ul> -->

    <table class="table table-hover">
      <thead>
          <th >Nome do Paciente</th>
          <th >Status</th>
          <th >Hora <br> Início</th>
          <th >Início <br> Previsto</th>
          <th >Fim <br> Previsto</th>
          <th >Saída <br>Presvista</th>
      </thead>
      <tbody id="tbCorpo">
      </tbody>
  </table>

</body>
</html>

<script>
  //1 - MANIPULAÇÃO DO ARRAY
  var pacientes = [""]
  if (pacientes == null) {
    pacientes = [];
  }else{
    pacientes = JSON.parse(localStorage.getItem("pacientes"))
  }

  function gravar() {
    var id = document.getElementById("id").value;
    var paciente = {};
    paciente.nome = document.getElementById("nome").value.toUpperCase();
    paciente.status = document.getElementById("status").value;
    paciente.local = document.getElementById("local").value;
    paciente.hora_inicio = document.getElementById("hora-inicio").value;
    paciente.inicio_previsto = document.getElementById("inicio-previsto").value;
    paciente.fim_previsto = document.getElementById("fim-previsto").value;
    paciente.saida_prevista = document.getElementById("saida-prevista").value;

    if (id == "") {
        pacientes.push(paciente);
    } else {
        pacientes[id] = paciente;
    }

    localStorage.setItem("pacientes", JSON.stringify(pacientes));
    mudarTabela();
  }

  function mudarTabela(){
    var pacientes = JSON.parse(localStorage.getItem("pacientes"));

    var tbCorpo = ""
    for (i in pacientes) {
        tbCorpo += `<tr onclick="editar(${i})">`;
        tbCorpo += `<td>${pacientes[i].nome}</td>`;
        tbCorpo += `<td>${pacientes[i].hora_inicio}</td>`;
        tbCorpo += `<td>${pacientes[i].inicio_previsto}</td>`;
        tbCorpo += `<td>${pacientes[i].fim_previsto}</td>`;
        tbCorpo += `<td>${pacientes[i].saida_prevista}</td>`;
        tbCorpo += `</tr>`;
    }
    // console.log(corpoTabela);
    document.getElementById("tbCorpo").innerHTML = tbCorpo;

  }

  function apagar(){
    var id = document.getElementById("id").value;
    if (id == "") {
        return;
    }
    if (confirm("Você realmente deseja apagar esse paciente?")) {
        pacientes.splice(id, 1);
        localStorage.setItem("pacientes", JSON.stringify(pacientes));
        mudarTabela();
    }
  }

  mudarTabela()

  
</script>