<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Centro Cirúrgico</title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

</head>
<body>
  
  <div class="container">
    <div class="alert alert-success" id="msg-alerta" style="display: none;">
      <a href="#" onclick="ocultar()" class="close" data-dismiss="alert" aria-label="close">&times;</a>
      <samp id="msg"></samp>
    </div>
    
    <form class="form-horizontal" action="">
      <input type="hidden" id="id">
      <div class="form-group">
        <h2>Painel Centro Cirurgico</h2>
        <!-- LINHA 1 -->
        <div class="row">
          <div class="col-sm-6">
            <label class="control-label" for="">Nome do paciente:</label> <br>

            <input type="nome" class="form-control" id="nome" placeholder="Enter nome" name="nome">
          </div>

          <div class="col-sm-3">
            <label class="control-label" for="">Status:</label> <br>

            <select id="status" class="form-control">
              <option value="1">Pré Operatório</option>
              <option value="2">Em sala de Cirurgia</option>
              <option value="3">Sala de Recuperação</option>
              <option value="4">Transferido</option>
            </select>
          </div>

          <div class="col-sm-3">
            <label class="control-label" for="">Local:</label> <br>

            <input type="nome" class="form-control" id="local">
          </div>
        </div> <br>

        <!-- LINHA 2 -->
        <div class="row">
          <div class="col-sm-3">
            <label class="control-label" for="">Hora início:</label> <br>

            <input id="hora-inicio" type="time" class="form-control">
          </div>

          <div class="col-sm-3">
            <label class="control-label" for="">Início Previsto:</label> <br>

            <input id="inicio-previsto" type="time" class="form-control">
          </div>

          <div class="col-sm-3">
            <label class="control-label" for="">Fim previsto:</label> <br>

            <input id="fim-previsto" type="time" class="form-control">
          </div>

          <div class="col-sm-3">
            <label class="control-label" for="">Saída prevista:</label> <br>

            <input id="saida-prevista" type="time" class="form-control">
          </div>

        </div>
      </div>

      <div class="form-group">
        <button onclick="novo()" class="btn btn-default">Novo</button>
        <button onclick="gravar()" class="btn btn-primary">Gravar</button>
        <button id="btApagar" disabled onclick="apagar()" class="btn btn-danger">Apagar</button>
      </div>
    </form> <br>

    <!-- TABELA -->
    <!-- <table class="table table-striped table-hover">
      <tbody id="tbCorpo">
        <thead>
          <tr>
            <th>Nome Paciente</th>
            <th>Status</th>
            <th>Hora Início</th>
            <th>Início Previsto</th>
            <th>Fim Previsto</th>
            <th>Saída Prevista</th>
          </tr>
        </thead>

      </tbody>
    </table>
    <ul class="pagination">
    </ul> -->

    <table class="table table-striped table-hover">
      <thead>
          <tr>
              <th>Nome Aluno</th>
          </tr>
      </thead>
      <tbody id="tbCorpo">

      </tbody>
  </table>
  <ul class="pagination">
  </ul>

</body>
</html>

<script>
  //1 - MANIPULAÇÃO DO ARRAY
  let pacientes = [{nome:  'SUYANNE SARA MIRANDA SILVA', status: '1', local: 'BRASÍLIA - DF', hora_inicio: '02:00', inicio_previsto: '02:15', fim_previsto: '05:03', saida_prevista: '05:15'}, {nome:  'LCUAS LUAN', status: '1', local: 'BRASÍLIA - DF', hora_inicio: '02:00', inicio_previsto: '02:15', fim_previsto: '05:03', saida_prevista: '05:15'} ];

  let qtPagina = Math.ceil(pacientes.length / 5);
  let pg = 0;

  if (localStorage.getItem('pacientes') == null) {
    gerarListaCpf();
  } else {
    pacientes = JSON.parse(localStorage.getItem('pacientes'));
  }

  function apagar() {
    let i = document.getElementById('id').value;
    if (i == '') {
        alert('Necessário selecionar um paciente.');
    }
    if (confirm("Realmente deseja apagar esse paciente?")) {
        pacientes.splice(i, 1);
        alert('Paciente removido');
        console.log(pacientes);
    }
    localStorage.setItem('pacientes', JSON.stringify(pacientes));
    carregaPg(0);
    novo();
    paginacao();
  }

  function ocultar() {
    document.getElementById('msg-alerta').style.display = 'none';
  }

  function carregaPg(n) {
    if (n < 0 || n > qtPagina - 1) return null;
    pg = n;
    let txtTabela = "";
    let i = n * 5;
    let f = i + 4;
    while (i <= f) {
      let paciente = (i >= pacientes.length) ? "&nbsp;" :pacientes[i];
      let nome = (paciente.nome == undefined) ? "&nbsp;" : paciente.nome;
      let edit = (paciente.nome == undefined) ? "&nbsp;" : `<span class="glyphicon glyphicon-eye-open"></span>`;
      let up = (paciente.nome == undefined) ? "&nbsp;" : `<span class="glyphicon glyphicon-arrow-up"></span>`;
      let down = (paciente.nome == undefined) ? "&nbsp;" : `<span class="glyphicon glyphicon-arrow-down"></span>`;

      txtTabela += `<tr>
              <td>${nome}</td>
              <td class='estilo-mouse' onclick='editar(${i})'>${edit}</td>
              <td class='estilo-mouse' onclick='mover(${i},-1)'>${up}</td>
              <td class='estilo-mouse' onclick='mover(${i}, 1)'>${down}</td>
          </tr>`;
      i++;
    }

    document.getElementById("tbCorpo").innerHTML = txtTabela;
    let tagLi = document.getElementsByTagName("li");

    for (let p = 0; p < tagLi.length; p++) {
        tagLi[p].classList.remove("active");
    }

    tagLi[pg + 2].classList.add("active");
  }

  function mover(i, m) {
    // 3 variaveis pra fazer a troca de dos alunos
    if (i + m < 0 || i + m > pacientes.length - 1) return;
    try {
        let temp = pacientes[i];
        pacientes[i] = pacientes[i + m];
        pacientes[i + m] = temp;
        carregaPg(pg);
        localStorage.setItem('pacientes', JSON.stringify(pacientes));
    } catch (error) {

    }
  }

  function gravar() {
    let i = document.getElementById("id").value;
    let paciente = {};
    paciente.nome = document.getElementById("nome").value;
    paciente.status = document.getElementById("status").value;
    paciente.local = document.getElementById("local").value;
    paciente.hora_inicio = document.getElementById("hora-inicio").value;
    paciente.inicio_previsto = document.getElementById("inicio-previsto").value;
    paciente.fim_previsto = document.getElementById("fim-previsto").value;
    paciente.saida_prevista = document.getElementById("saida-prevista").value;
    

    if (!validacoes(paciente)) return;

    // condição que identifica que será gravado um novo aluno.
    if (i == '') {
        i = pacientes.length;
        pacientes[i] = {};
    }
    pacientes[i].nome = document.getElementById("nome").value;
    pacientes[i].status = document.getElementById("status").value;
    pacientes[i].local = document.getElementById("local").value;
    pacientes[i].hora_inicio = document.getElementById("hora-inicio").value;
    pacientes[i].inicio_previsto = document.getElementById("inicio-previsto").value;
    pacientes[i].fim_previsto = document.getElementById("fim-previsto").value;
    pacientes[i].saida_prevista = document.getElementById("saida-prevista").value;
    
    localStorage.setItem('pacientes', JSON.stringify(pacientes));
    carregaPg(pg);
    novo();
    paginacao();
    let elemento = document.getElementById('msg-alerta');
    elemento.classList.add("alert-success");
    elemento.classList.remove("alert-danger");
    elemento.style.display = '';
    document.getElementById('msg').innerHTML = `<strong>Sucesso!</strong> Alteração gravada.`;

  }







  


  
</script>